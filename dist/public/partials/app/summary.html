<div id="view-findings" 
	ng-model='test'
	ng-class="{ 'show-comments' : showCommentToggle !== 'hide' }" 
	>
	

	<div id="nav-logo">
		<a href="/overview"><img src="/layout/assets/fg-binocs-header.png" /></a>
	</div>
	
	
	
	<!-- findings nav -->
	<div id="findings-nav">
		
		<div id="sidebar" class="summarizing">
			
			<div class="test-id">
				<h3>{{testname}}</h3>
				<small>Editing</small>
			</div>
			
			<ul>
				<!-- OVERVIEW -->

				<li 
				ng-repeat="object in leftNavList" 
				ng-class="{ 'active': $index == selectedIndex }" 
				ng-click="activate(object, $index)">
					
					<!-- <div class="step-ordering"> -->
					<div class="step-ordering">
                        <div class="elevator" ng-click="moveTask($index, -1)" >&#9650;</div>
                        <div class="elevator" ng-click="moveTask($index, 1)" >&#9660;</div>
                    </div>
                    
					<span ng-show="object.doctype === 'tag'">#</span>{{object.name}}
					
					<div class="sidebar-visibility">
						<a ng-click="toggleVis(object)" ng-show="object.visible">
							<img src="/layout/assets/show.svg" />
						</a>
						<a ng-click="toggleVis(object)" ng-show="!object.visible">
							<img src="/layout/assets/hidden.svg" />
						</a>
					</div>
					
					<div class="clear"></div>

				</li>
				
			</ul>
		</div>
		
		<!-- findings controls -->
		
		<div id="findings-viewmode-controls">		
		
			<div id="findings-share-link" ng-if="showReportLink">
				<small>Use this link to share this report:</small>
				<input class="input small tight" ng-model="reportLink"/>
			</div>	
		
			<a class="button small disabled">Edit</a>
			<a class="button small" ng-click="reportPreview()">Preview</a>
			<button class="button small secondary" ng-click="toggleReportLink()">Share</button> 
		</div> 	
		
		
		
	</div>
				
	<!-- main content -->
	<div class="sheet-holder">						
		<div class="sheet" ng-model="selected">
			
			<div class="findings-header">	
				<h3 class="dark float-left"><span ng-show="selected.doctype === 'tag'">#</span>{{selected.name}}</h3>
				
				
				<!-- task rating widget -->
				<div class="task-rating" ng-show="selected.pass_fail == false">
					<small>Rating</small>
					<div class="task-rating-doot task-rating-plus hollow" ng-click="passFail(selected)">&nbsp;</div>
					<div class="task-rating-doot task-rating-minus">&nbsp;</div>
				</div>
				
				<div class="task-rating" ng-show="selected.pass_fail == true">
					<small>Rating</small>
					<div class="task-rating-doot task-rating-plus">&nbsp;</div>
					<div class="task-rating-doot task-rating-minus hollow" ng-click="passFail(selected)">&nbsp;</div>
				</div>
				<!-- task rating -->
				
				
				<div class="clear"></div>	
				
			</div>
			
			
			<textarea msd-elastic class="input findings-summary" id="field-textarea" placeholder="Summarize your learnings and takeaways from this task or tag."  ng-model="selected.summary" ng-blur="saveObject(selected)"></textarea>
			
			<!-- SORT OUT YOUTUBE LINKS -->

			
			<form id="video-embed">
				<p>Do you have a relevant video for this task or theme? <a ng-click="showEmbed = ! showEmbed">Include it</a> in your report. </p>
				
				<div id="video-embed-form" ng-show="showEmbed">
					<small>For Youtube, paste your video URL, like https://www.youtube.com/watch?v=ABCD1234. For everything else, use the native embed code.</small>
					<textarea ng-model='selected.embed' class="input" name="field-input" placeholder="Your embed code." ng-blur="saveObject(selected)"></textarea>
				</div>

				<!--<button ng-click="saveObject(selected)">Add Video</button>-->
			 </form>
			 
			 
			 

			<!-- messages -->					
			<div class="message-group" ng-repeat="user in messages" ng-show="selected._messages">
			
			
				
				<!-- participant name -->
				<div class="message-user">
					<img src="/layout/assets/avatar.svg" /> {{user[0]._subject.name}}
					<div class="expand-button float-right" ng-show="selected.doctype === 'task'">
						<div class="expand-button-body small" ng-click="toggleNote(user[0]._subject._id)">+</div>
						<div class="expand-button-helper small">Add new note?</div>
					</div>
					
					<div class="clear"></div>
				</div>
				
				
				<!-- input notes -->
				<div class="message-input" ng-show="inputNote === user[0]._subject._id">
					<textarea class="input" ng-model='newnote' name="field-input" placeholder="Your new notes for this participant">
					</textarea>
					<button class="button small" ng-click="postMessage(newnote, user[0]._subject)">Add Note</button>
				</div>
			
				
				
				<!-- message -->
				<div ng-repeat="message in user" class="message" 
				ng-show="showObjectMessages(message, selected)"
				ng-class="{selected: commentMessage._id === message._id}">
									
					
					<!--<div class="message-edit"><img src="/layout/assets/pencil.svg"/></div>-->
					
					<div class="message-body" ng-click="editMessage(message, $index)">
						<p ng-bind-html="message.body | hashtag" ng-show="messageEditToggle != message._id"></p>
						<textarea class="input" ng-model="message.body" ng-show="messageEditToggle ==  message._id" ng-blur="saveEdit(message)" ui-keypress="{13:'saveEdit(message)'}"></textarea>
						<!--<small>{{message.created | date : 'HH:mm' }}</small>-->
					</div>
					
					
					
					<div class="message-fave" ng-show="selected.doctype === 'task'">
						<a ng-click="saveFav(message)" ng-if="message.fav_task">
							<img src="/layout/assets/show.svg" />
						</a>
						<a ng-click="saveFav(message)" ng-if="!message.fav_task" >
							<img src="/layout/assets/hidden.svg" />
						</a>
					</div>
					
					<div class="message-fave" ng-show="selected.doctype === 'tag'">
						<a ng-click="saveFav(message)" ng-if="message.fav_tag">
							<img src="/layout/assets/show.svg" />
						</a>
						<a ng-click="saveFav(message)" ng-if="!message.fav_tag" >
							<img src="/layout/assets/hidden.svg" />
						</a>
					</div>
					
					
			
					<div class="clear"></div>
					
					<!-- if comments, display count -->
					<div class="message-comment-count" ng-show="message._comments.length > 0" ng-click="showComments(message)">
						{{ message._comments.length}}
					</div>

					<!-- if no comments -->
					<div class="message-comment-count empty" 
						ng-show="message._comments.length === 0 || !message._comments" ng-click="showComments(message)">
						+
					</div>
					
					<div class="message-comments" ng-show="commentMessage._id === message._id">
						<!-- if comments, display coments -->
						<div class="message-comment" ng-repeat="comment in message._comments">
							<small><strong>{{comment.name}}</strong> {{comment.created | date:'MMM d yyyy'}}</small>
							<p>{{comment.body}}</p>
						</div>

						<!-- message-comment new -->
						<div class="message-comment-submit">
							<form ng-model="comment">
								<textarea class="input small" ng-model="comment.body"> </textarea>
								<small><a ng-click="addComment(comment)">Add comment</a></small>
							</form>
						</div>
					</div>
					<!-- / display comments -->
					
		
					
					
				</div>
				<!-- / message -->
		
			</div>
			<!-- /messages -->
			
			
		</div>
	</div>
	<!-- / main content -->




</div>